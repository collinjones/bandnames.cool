{% extends 'main/base.html' %}

{% load static %}
{% load profanity %}

{% block title %} {{ title }} {% endblock %}
{% block body %}

<script>
var bandnames = {}
var profanity_filter = "{{profanity_filter}}"
'{% for bandname in bandnames %}'
    bandnames["{{bandname}}"] = '{{bandname|censor}}'
'{% endfor %}'
</script>

<script src="{% static 'main/scripts/button-swap.js' %} "></script>

<!-- p5.js sketches  -->
<script src="{% static 'main/scripts/p5/wheel/wheel.js' %} "></script>
<script src="{% static 'main/scripts/p5/wheel/sketch.js' %} ", id = "wheel-script" data-bandnames ="{{bandnames}}"></script>
<div id = 'submission-contents-div'>
    <!-- Submission form div -->
    <div id = "submission-form">
        <div id="submission-img-contents">
            <h2 id="submission-status"></h2>
            <div id="swap-contents">
                <h3 id="bandnames-count">Bandnames: {{count}}</h3>
                <h3> Submit a bandname </h3>
            </div>
            <form enctype="multipart/form-data" method="post" id="post-form">
                <input id="bandname" class = "cursor-text">
                <img class="noselect" onmousedown="clicked()" onmouseup="resting()" onmouseout="dragged()" id="bandname-submit"  type="submit" draggable = false value="Submit" src="static/images/button.png"/>
            </form>
        </div>
        <image draggable = false src="{% static 'images/placard-square.png' %}" id="submit-img"></image>
    </div>

    <button id="spin-button" class="pixelated-font cursor-default">Spin Wheel</button>
    <button id="stop-button" class="pixelated-font cursor-default">Stop Wheel</button>
    <button id="mute-button" class="pixelated-font cursor-default">Mute Wheel</button><br>
    <input type="range" min="0" max="0.1" value="0" id="volume-slider" step="0.001">
    <h3 class="vote-form-div" id="bandname-selected"><img src="../../static/gifs/loading.gif" alt="loading wheel..."  width="45"/></h3>
    <form enctype="multipart/form-data" method="post" id="vote-form">
        {% csrf_token %}
        {% if user.is_authenticated %}
            <button id="upvote-button" href="{% url 'vote' %}" class="pixelated-font cursor-default">Upvote</button>
            <button id="downvote-button" href="{% url 'vote' %}" class="pixelated-font cursor-default">Downvote</button>
        {% else %}
            <button id="upvote-button" href="{% url 'vote' %}" class="pixelated-font cursor-default" disabled>Upvote</button>
            <button id="downvote-button" href="{% url 'vote' %}" class="pixelated-font cursor-default" disabled>Downvote</button>
        {% endif %}
    </form>
</div>
<div class = "sketch-grid-container">
    <!-- Div for the p5.js sketch (Bandname Wheel) -->
    <div class = "sketch-div" id = "sketch-holder" style="touch-action:none"></div>
    <!-- Div for the selected bandname from the wheel -->
    <div class="voted-history-div" id="voting-system">
        <image draggable = false class='noselect' src="{% static 'images/scroll.png' %}" id="scroll-img"></image>
        <table id="bandnames-table-voted"  class="display">
            <thead>
                <tr>
                    <th>BANDNAME</th>
                    <th class="score-header">SCORE</th>
                </tr>
            </thead>
            <tbody id='bandnames-table-voted-body'></tbody>
        </table>
    </div>
</div>

<!-- Empty loading screen (another sketch could go here) -->
<div id ="p5_loading"></div>


{% endblock %}


